package com.gnm.finalprojek.fragmentsimport android.content.Intentimport android.os.Bundleimport android.support.v4.app.Fragmentimport android.support.v4.widget.SwipeRefreshLayoutimport android.support.v7.widget.LinearLayoutManagerimport android.support.v7.widget.RecyclerViewimport android.util.Logimport android.view.LayoutInflaterimport android.view.Viewimport android.view.ViewGroupimport android.widget.*import com.gnm.finalprojek.Rimport com.gnm.finalprojek.activities.DetailMatchimport com.gnm.finalprojek.activities.SearchActivityimport com.gnm.finalprojek.activities.TeamDetailimport com.gnm.finalprojek.api.ApiRequestimport com.gnm.finalprojek.data.EventAdapterimport com.gnm.finalprojek.data.TeamsAdapterimport com.gnm.finalprojek.data.models.Teamsimport com.gnm.finalprojek.presenters.match.PastMatchPresimport com.gnm.finalprojek.presenters.team.TeamPresenterimport com.gnm.finalprojek.views.TeamsViewimport com.google.gson.Gsonimport org.jetbrains.anko.sdk27.coroutines.onClickimport org.jetbrains.anko.support.v4.ctximport org.jetbrains.anko.support.v4.onRefreshclass TeamsFrag : Fragment(), TeamsView {    lateinit var spinner: Spinner    lateinit var recyclerView: RecyclerView    lateinit var presenter: TeamPresenter    lateinit var adapterTeams: TeamsAdapter    lateinit var pgBar: ProgressBar    lateinit var swipeRefreshLayout: SwipeRefreshLayout    var listTeam: MutableList<Teams> = mutableListOf()    lateinit var button: Button    private lateinit var leagueName: String    lateinit var idLeague: String    lateinit var rootView: View    override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {        rootView = inflater.inflate(R.layout.teams_frag, container, false)        init()        return rootView    }    override fun init() {        button = rootView.findViewById(R.id.search)        button.onClick {            SearchActivity.caller = "teams"            val intent = Intent(context, SearchActivity::class.java)            startActivity(intent)        }        pgBar = rootView.findViewById(R.id.pgBars)        swipeRefreshLayout = rootView.findViewById(R.id.swiping)        spinner = rootView.findViewById(R.id.spinnerLiga)        recyclerView = rootView.findViewById(R.id.recTeam)        val gson = Gson()        val request = ApiRequest()        presenter = TeamPresenter(this, request, gson)        val spinnerItems = resources.getStringArray(R.array.league)        val spinnerAdapter = ArrayAdapter<String>(ctx, R.layout.spinner_item, spinnerItems);        spinner.adapter = spinnerAdapter        spinner.onItemSelectedListener = object : AdapterView.OnItemSelectedListener {            override fun onNothingSelected(parent: AdapterView<*>?) {            }            override fun onItemSelected(parent: AdapterView<*>?, view: View?, position: Int, id: Long) {                loadData()            }        }        swipeRefreshLayout.onRefresh {            loadData()        }        adapterTeams = TeamsAdapter(this.context!!, listTeam) {            TeamDetail.caller = "teams"            val intent = Intent(this.context, TeamDetail::class.java)            intent.putExtra("idTeam", it)            startActivity(intent)        }        loadData()    }    fun loadData() {        recyclerView.layoutManager = LinearLayoutManager(ctx)        recyclerView.adapter = adapterTeams        presenter = TeamPresenter(this, ApiRequest(), Gson())        leagueName = spinner.selectedItem.toString()        getIdLeague(leagueName)        presenter.getTeam(idLeague)    }    fun getIdLeague(leagueName: String) {        when {            leagueName.equals(getString(R.string.english_premier_league)) -> idLeague = "4328"            leagueName.equals(getString(R.string.english_league_championship)) -> idLeague = "4329"            leagueName.equals(getString(R.string.german_bundesliga)) -> idLeague = "4331"            leagueName.equals(getString(R.string.italian_serie_a)) -> idLeague = "4332"            leagueName.equals(getString(R.string.french_ligue_1)) -> idLeague = "4334"            leagueName.equals(getString(R.string.spanish_la_liga)) -> idLeague = "4335"        }    }    override fun Loading() {        swipeRefreshLayout.isRefreshing = true    }    override fun LoadingFinish() {        swipeRefreshLayout.isRefreshing = false    }    override fun ShowData(data: List<Teams>) {        listTeam.clear()        listTeam.addAll(data)        adapterTeams.notifyDataSetChanged()    }    override fun onActivityCreated(savedInstanceState: Bundle?) {        super.onActivityCreated(savedInstanceState)        init()    }}